!function(e){function a(){}e.fn.geoPicker=function(a,t){var r={address2geo:function(e,a){GMaps.geocode({address:e,callback:a})},geo2address:function(a,t){e.getJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+a+","+t+"&key="+e.fn.geoPicker.defaults.apiKey,function(a){a.hasOwnProperty("results")&&a.results.length>0&&e("#Address").val(a.results[0].formatted_address)})}};switch(typeof a){case"undefined":case"object":return this.each(function(){var t,r,c,o,i;if(!e(this).data().hasOwnProperty("geopicker")){var n=function(){e(o).geoPicker("search",this.value)};if(o=e(this),s=e.extend({id:o.attr("id")+"-geopicker",insertAfter:o},e.fn.geoPicker.defaults,a||{},{searchMarker:c}),s.el=s.id,i=e(s.template.replace(/:id/g,s.id).replace(":class",s.class).replace(":style",s.style)).insertAfter(s.insertAfter),t=new GMaps(s),s.addSearch&&(t.addControl({content:s.searchTemplate.replace(":searchLabel",s.searchLabel).replace(":searchPlaceholder",s.searchPlaceholder),position:"top_right"}),e(i).on("change","input.geopicker-search",n),e(i).on("click","button.geopicker-btn",n),e(i).on("keypress","input.geopicker-search",function(e){13==e.keyCode&&(e.stopPropagation(),e.preventDefault(),n.call(this))})),t.on("click",function(e){r&&t.removeMarker(r),r=t.addMarker({title:s.pickedTitle,lat:e.latLng.k,lng:e.latLng.D,icon:s.chooseIcon}),t.setCenter(e.latLng.k,e.latLng.D),s.onPick.call(o,[e.latLng.D,e.latLng.k],e),o.val(e.latLng.k+","+e.latLng.D)}),console.log(s.searchMarker),e(this).data("geopicker",s).data("gmap",t).data("map",i),e(i).data("input",o),o.val()){var l=o.val().split(",");r=t.addMarker({lat:l[0],lng:l[1],icon:s.chooseIcon}),t.setCenter(l[0],l[1]),t.fitZoom(),t.zoomOut(6)}}});case"string":switch(a){case"gmap":return e(this).first().data("gmap");case"options":return e(this).first().data("geopicker");case"map":return e(this).first().data("map");case"remove":return this.each(function(){e(this).data("map").remove(),e(this).removeData("geopicker").removeData("gmap").removeData("map")});case"search":if(inputElement=e(this).first(),e(inputElement).data().hasOwnProperty("geopicker")){var s=e(inputElement).data("geopicker"),c=e(inputElement).data("gmap");r.address2geo(t,function(a,t){if("OK"===t){var r=a[0].geometry.location;c.setCenter(r.lat(),r.lng()),s.searchMarker&&c.removeMarker(s.searchMarker),s.searchMarker=c.addMarker({lat:r.lat(),lng:r.lng(),title:e(inputElement).data("geopicker").searchTitle,icon:e(inputElement).data("geopicker").searchIcon}),e(inputElement).data("geopicker",s)}})}return this}}},e.fn.geoPicker.defaults={template:"<div id=':id' style=':style' class='geopicker-container :class'></div>",searchTemplate:"<input class='geopicker-search' placeholder=':searchPlaceholder' /><button class='geopicker-btn'>:searchLabel</button>",searchLabel:"Search",searchPlaceholder:"Search",searchTitle:"Search result",searchIcon:"http://maps.google.com/mapfiles/ms/icons/green-dot.png","class":"gllpMaps",style:"height: 200px; width: 100%; position: relative;",lat:21.4224843,lng:39.8262017,zoom:8,autoFit:!1,apiKey:"someapi",disableDefaultUI:!1,streetViewControl:!1,mapTypeControl:!1,onPick:a,addSearch:!0}}(jQuery);